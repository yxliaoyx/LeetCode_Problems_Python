from collections import deque


class Solution:
    def minMalwareSpread(self, graph: List[List[int]], initial: List[int]) -> int:
        adj = [[j for j, val in enumerate(row) if val] for row in graph]
        initial.sort()

        def bfs(remove):
            q = deque(x for x in initial if x != remove)
            seen = set(q)
            while q:
                u = q.popleft()
                for v in adj[u]:
                    if v != remove and v not in seen:
                        seen.add(v)
                        q.append(v)
            return len(seen)

        answer, min_count = -1, float("inf")
        for u in initial:
            count = bfs(u)
            if count < min_count:
                answer, min_count = u, count

        return answer
